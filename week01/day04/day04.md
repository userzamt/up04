# День 04. PowerShell. SSH. CRON. Ввод в домен

## SSH
Функция удаленного взаимодействия PowerShell обычно использует службу *WinRM* для согласования соединения и передачи данных. Теперь протокол SSH доступен на платформах Linux и Windows, что позволяет осуществлять многоплатформенное удаленное взаимодействие с PowerShell.

*SSH* (англ. Secure Shell — «безопасная оболочка») — сетевой протокол прикладного уровня, позволяющий производить удалённое управление операционной системой и туннелирование TCP-соединений (например, для передачи файлов). Шифрует весь трафик, включая и передаваемые пароли. SSH допускает выбор различных алгоритмов шифрования. SSH-клиенты и SSH-серверы доступны для большинства сетевых операционных систем.

Удаленное взаимодействие по SSH позволяет осуществлять базовое удаленное взаимодействие между компьютерами с Windows и Linux в рамках сеансов PowerShell. Функция удаленного взаимодействия по SSH создает хост-процесс PowerShell на целевом компьютере в качестве подсистемы SSH. 

Решение **OpenSSH** для Windows теперь доступно в Windows 10 сборки 1809 и Windows Server 2019. 

Установка модуля **OpenSSH**(клиента *ssh.exe*)
```powershell
Get-WindowsCapability -Online | where name -like "*OpenSSH*"

Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0
```

Подключение к ПК по SSH
```bash
ssh user@192.168.1.1
```

## CRON
**cron** - это планировщик, который позволяет выполнять нужные вам скрипты раз в час, раз в день, неделю или месяц, а также в любое заданное вами время или через любой интервал. Программа часто используется даже другими службами операционной системы. 

 Его основная задача выполнять нужные процессы в нужное время. Существует несколько конфигурационных файлов, из которых он берет информацию о том что и когда нужно выполнять.

+ `/etc/cron.minutely` - каждую минуту;
+ `/etc/cron.hourly` - каждый час;
+ `/etc/cron.daily` - каждый день;
+ `/etc/cron.weekly` - каждую неделю;
+ `/etc/cron.monthly` - каждый месяц.

```powershell
# редактирование планировщика заданий
crontab -e

# список заданий
crontab -l
```

## Практическое задание
>[!CAUTION]
> Все проделанные Вами действия должны быть отражены в отчёте в виде скриншотов

1. Создать две виртуальные машины. На одну установить Windows Server 2012 R2(используйте машину из предыдущего задания). На другую виртуальную машину установить РЕД ОС 8(используйте машину из предыдущего задания). Для каждой машины создать снимок состояния.

1. РЕД ОС ввести в домен. Ввод в домен производить с помощью графических утилит. Перезагрузите виртуальную машину и войдите в систему под доменной учетной записью.

> [!IMPORTANT]
> [Документация РЕД ОС. Предварительная подготовка компьютера к вводу в домен](https://redos.red-soft.ru/base/arm/arm-domen/arm-msad/prejoindomain/)
>
> [Графический режим работы программы ввода/вывода РЕД ОС из домена](https://redos.red-soft.ru/base/redos-7_3/7_3-administation/7_3-domain-redos/7_3-arm-msad/7_3-join-to-domain/#graph)
>
> [Отключение SELINUX](https://redos.red-soft.ru/base/arm/arm-other/disable-selinux/?ysclid=lwirom1xhj256263963)

1. На локальную машину установить модуль **OpenSSH.Client**. 

>[!WARNING]
> На ПК с установленным модулем **OpenSSH.Client** необходимо его удалить и установить заново.

1. Подключитесь по *ssh* к виртуальной машине с РЕД ОС используя доменную учетную запись. По необходимости воспользоваться утилитой *usermod*

>[!NOTE]
> [Список доменных учётных записей для входа](login.csv)

1. Написать bash скрипт по поиску сообщений со статусом *Warning* в лог файле демона *mysqld*. Файл находится `/var/log/mysqld.log`. Вывод должен соответствовать следующему примеру:
```bash
2024.12.01 13:05 Text messages
```

1. Используя *cron* организовать отправку результатов работы bash скрипта из предыдущего задания на Вашу почту каждую минуту.

>[!NOTE]
>[Планировщик задач в РЕД ОС. Cron](https://rutube.ru/video/f85b5dd4e1e1c0a8aa81de8f65727be8/?ysclid=lwis6acoyk286369469)

